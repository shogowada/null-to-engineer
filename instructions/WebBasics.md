# ウェブの仕組み

ウェブの開発を始める前に、これからよく出てくる単語の意味を知るためにウェブの基本的な仕組みについて見ていこう 😄
すでに知っている場合は飛ばしても問題ないし、今全部覚えなくても大丈夫だよ！

## ウェブって何？

ウェブ（Web、World Wide Web、WWW、W3）はインターネット上に公開されたウェブページ達を接続しているシステムのことだよ。

ここではどうやってそのシステムが作られているのか、そのシステムの部品を一つずつみながら学んで行こうね 😶

## ウェブサーバー

ウェブサーバーはウェブ上の色々なものを供給（サーブ）するものだよ 🙌

「色々なもの」というのは、例えば HTML や CSS、JavaScript などから始まって、他にも画像とか動画とか、必要なもの全部だよ。

ウェブ上で手に入るものは、全てウェブサーバーから供給されているんだ 😲

## ウェブクライアント

ウェブクライアントはウェブサーバーに接続して、必要なものをダウンロードするもののことなんだ 🙂

もしウェブサーバーが他のウェブサーバーから何かをダウンロードする場合、
そのウェブサーバーはウェブクライアントとしても機能していることになるね 🧐

ウェブクライアントがウェブサーバーから何かをダウンロードするときは、HTTP（エイチ・ティー・ティー・ピー）リクエストというものを送るよ。
ウェブサーバーはそれに対して HTTP リスポンス（返事）を送り返すことで、ダウンロードが完了するんだ。
何やら HTTP って難しい単語が出てきたね！HTTP に関しては後でもうちょっと詳しく説明するから、今はあまり深く考えなくてもいいよ 😊

## ウェブブラウザ

ウェブブラウザはウェブクライアントの一種で、ウェブサーバーからダウンロードしたものを表示したり実行したりするものだよ。
例えば Chrome や Firefox、Safari や Edge は全部ウェブブラウザなんだ 😄

## IP アドレス

ウェブクライアントがウェブサーバーに HTTP リクエストを送るときに、まずウェブサーバーの場所を分かってなきゃいけないよね 🤔
その場所を記したのが [IP アドレス](https://ja.wikipedia.org/wiki/IPアドレス)と呼ばれるものなんだ。「アドレス」は日本語で「住所」だよ。

現在 IP アドレスには大きく分けて２種類あって、１つは IPv4、もう１つは IPv6 と呼ばれているよ。

IPv4 のアドレスは`192.0.2.1`のような感じで、IPv6 のアドレスは`2001:db8:0:1234:0:567:8:1`のような感じだよ。IPv6 の方が長いね！

実は少し前までは IPv4 までしかなかったんだけど、それじゃ IP アドレスが足りなくなるかもしれないってことで IPv6 も新しく作られたんだ。
ウェブサーバーによっては IPv4 も IPv6 も両方持っていることもあるけど、まだまだ IPv4 の方を多くみるかもしれないね 🙂

## ポート

ウェブクライアントがウェブサーバーに何かを送るときには、IP アドレスの他にポートも必要になるんだ 😶

IP アドレスはウェブサーバーの場所を示しているのに対して、ポートはそのウェブサーバー内での場所を示しているよ。
ホテルに例えるなら IP アドレスがホテルの住所、ポートは部屋番号みたいなものだね 🚪

ポートは`0`から`65535`の数字で表されるんだ。
その中でも`0`から`1024`までのポートは Well Known Port（ウェル・ノウン・ポート）と呼ばれていて、色々なプロトコルがデフォルトで使うポートとして予約されているよ。
例えばウェブで使う HTTP は`80`、HTTP の暗号化されたバージョンの HTTPS は`443`をデフォルトで使うよ。
気になる人は[一覧](https://ja.wikipedia.org/wiki/TCPやUDPにおけるポート番号の一覧)を見てみてね！

２つのアプリが１つのポートを共有することはできないから、アプリは基本的に早い者勝ちでポートを予約することになるよ。
もし他のアプリが使っているポートを使おうとするとエラーになるんだ 😲

## DNS

IP アドレスでウェブサーバーの場所はわかるんだけど、IP アドレスって人間には覚えにくいよね 😵

[DNS（ディー・エヌ・エス、Domain Name System）](https://ja.wikipedia.org/wiki/Domain_Name_System)はドメインネームと呼ばれるものを IP アドレスに変換してくれるものだよ。

ドメインネームは google.com とか yahoo.com とかのこと。
DNS のおかげで Google や Yahoo の IP アドレスを覚えなくても、ドメインネームを知っているだけで Google や Yahoo のウェブサーバーに HTTP リクエストを送ることができるんだね 😊

## URL

[URL](https://ja.wikipedia.org/wiki/Uniform_Resource_Locator)（ユー・アール・エル、Uniform Resource Locator）はウェブ上のどこに「リソース」があるかを記述したものだよ。
リソースっていうのは例えば HTML、CSS、JavaScript のファイルだったり、動画や画像だったり、他のデータだったり、とにかくウェブ上にあるもののことをいうよ 😄

URL はウェブサーバーの場所と、そしてそのウェブサーバーの中でもどこにリソースがあるかを記述しているんだ。

URL 自体は HTTP リクエスト以外にも使われるんだけど、ここでは HTTP リクエストに絞って説明するね。

URL は https://www.google.com/search?q=programming のような見た目をしているよ 😶

最初の`https`の部分はスキームと呼ばれていて、HTTP（暗号化なし）で接続するか、HTTPS（暗号化あり）で接続するかの定義をしているよ。

次の`www.google.com`の部分は[ホスト名](https://ja.wikipedia.org/wiki/ホスト名)。
ここでは`www`というローカルホスト名に`google.com`というドメイン名がついているね。
これ全部で１つのホスト名になるよ。これがウェブサーバー自体の場所を表しているんだ。

次はポート番号を記述することになるんだけど、`http`や`https`のスキームにはデフォルトのポート番号が振り当てられていて、
それぞれ`80`と`443`だから、記述されていない場合はデフォルトのポート番号を使うことになるよ 🙂
もし記述したい場合は https://www.google.com:443/search?q=programming のように、`:`を使ってホスト名の後につけてね 😄

次の`/search`の部分はパスと呼ばれていて、そのポートを使っているアプリのどこに HTTP リクエストを送るかを記述しているんだ。

次の`?q=programming`の部分はクエリ文字列と呼ばれていて、ウェブサーバーに渡すことができる追加の情報だよ。
ここでは`q=programming`という情報を渡しているね。Google はこの情報があるから「`programming`って検索すればいいんだな」って分かるんだ 😲

クエリ文字列は他にもクエリストリングやクエリパラメータと呼ばれることもあるよ。

## HTTP

[HTTP（エイチ・ティー・ティー・ピー、Hypertext Transfer Protocol）](https://ja.wikipedia.org/wiki/Hypertext_Transfer_Protocol)はウェブで使う通信プロトコルだよ。
通信プロトコルっていうのは、通信するときに「こういうデータ送ったらこういう意味だからね」っていう決まり事の集まりのこと 🤝
ウェブサーバーとウェブクライアントがみんな HTTP で通信することによって、お互いに何を言っているのか分かるようになっているんだね。

ウェブクライアントからウェブサーバーに送るデータのことを HTTP リクエスト、それの返事のことを HTTP リスポンスというよ 😊

### HTTP リクエスト

HTTP リクエストはウェブクライアントからウェブサーバーに送るリクエスト 😄
パス、メソッド、ヘッダ、そしてボディから成り立っているんだ。
どんなリクエストが有効かは全部ウェブサーバー側が勝手に決めるから、ウェブサーバーによってどんなパス、メソッド、ヘッダ、そしてボディを受け付けているか予め知っておく必要があるよ 😊

パスはウェブサーバーのどのリソースにリクエストを送るかを記述しているよ。
例えばあるウェブサーバーが`/foo`にリソースを置いているとすると、リクエストのパスを`/foo`に設定することでそのリソースに対してリクエストを送ることができるよ。

メソッドはどんなリクエストを送るかを指定するんだ。
主に GET、PUT、POST、そして DELETE があるよ。
他にもあるんだけど、ここではその基本の４つだけに絞って説明するね 🤗

- GET はリソースをダウンロードしたいときに使う。
- PUT はリソースを編集したいときに使う。
- POST はリソースを追加したいときに使う。
- DELETE はリソースを消したいときに使う。

ヘッダはリクエストと一緒に追加の情報を渡すことができるよ。
例えばリクエストのボディのフォーマットだったり、ユーザー認証のアクセストークンだったり。

ボディはメソッドが PUT と POST のときに使えて、例えば PUT だったらリソースをどう編集するか、POST だったらどんなリソースを追加するかを渡すために使うんだ 😄

### HTTP リスポンス

HTTP リスポンスはウェブサーバーがウェブクライアントに送る、HTTP リクエストに対する返事だよ。
HTTP リスポンスは[ステータス](https://developer.mozilla.org/ja/docs/Web/HTTP/Status)、ヘッダ、そしてボディから成り立っているんだ 🙂

ステータスはリクエストが成功したか失敗したかを表す数字だよ。
ステータスは３桁の数字で（例：101、200、307、404、503）、１００の桁が１なら「情報」、２なら「成功」、３なら「リダイレクト」、４なら「クライアントエラー」、そして５なら「サーバーエラー」となるよ。

１の「情報」については直接使うことがあまりないから今は気にすることはないんだけど、これを使ってプロトコルを切り替えたり、「リクエストを受け取ったけど、まだ処理してるよ」と教えることもできるんだ。

２の「成功」は、リクエストが正しく受理されたときに送るステータスなんだ。例えば 200（OK）を送ると、リクエストの成功を表すよ。200 は一番よくみるステータスかもね 😄

３の「リダイレクト」は、リクエストを完了させるときに追加で処理が必要な場合に送られるよ。
例えば 307（Temporary Redirect）だと一時的に違う場所に同じリクエストを送って欲しいときに使うんだ。

４の「クライエントエラー」は、ウェブクライアント側が間違ったリクエストを送ってきたときに使うステータス。
例えば 400（Bad Request）だとリクエスト自体がもう意味不明なときに使われるんだ 🤪
他にも 401（Unauthorized）はリクエストのユーザー認証ができなかったときに使われるし、404（Not Found）は存在しないパスにリクエストが送られてきたときに使うよ 😊

５の「サーバーエラー」は、リクエストは正しいんだけど、サーバー側でエラーが発生したときに使われるよ 😲
例えば 500（Internal Server Error）はとりあえず何かエラーが起きたときに使われる。
503（Service Unavailable）は一時的にサーバーにアクセスできない状態のときに使われるステータスだよ。

ヘッダとボディはリクエストのときと同じ用途で使われるよ 🙂
